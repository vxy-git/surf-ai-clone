# ğŸ”§ LunarCrush API ä¿®å¤è¯´æ˜

## ğŸ› é—®é¢˜æè¿°

### ç—‡çŠ¶
å½“è¯¢é—® "What's the sentiment for Bitcoin?" æ—¶,è¿”å›çš„æ˜¯æ¨¡æ‹Ÿæ•°æ®è€ŒéçœŸå®çš„ LunarCrush æ•°æ®ã€‚

### é”™è¯¯æ—¥å¿—
```
Social sentiment API error: Error: fetch failed
at context.fetch (.../next/dist/server/web/sandbox/context.js:321:60)
```

### æ ¹æœ¬åŸå› 
**Next.js Edge Runtime çš„é™åˆ¶**

Edge Runtime è¿è¡Œåœ¨å—é™çš„æ²™ç®±ç¯å¢ƒä¸­,å¯¹æŸäº›å¤–éƒ¨ API çš„ fetch è¯·æ±‚æœ‰é™åˆ¶,å¯¼è‡´ LunarCrush API è°ƒç”¨å¤±è´¥ã€‚

---

## âœ… è§£å†³æ–¹æ¡ˆ

### ä¿®æ”¹å†…å®¹

#### 1. `src/app/api/chat/route.ts`
```typescript
// ä¹‹å‰
export const runtime = 'edge';

// ä¹‹å (å·²æ³¨é‡Š)
// export const runtime = 'edge';
```

#### 2. `src/app/api/research/route.ts`
```typescript
// ä¹‹å‰
export const runtime = 'edge';

// ä¹‹å (å·²æ³¨é‡Š)
// export const runtime = 'edge';
```

### æ•ˆæœ
- âœ… æ”¹ç”¨ Node.js Runtime
- âœ… æ”¯æŒå®Œæ•´çš„ç½‘ç»œè¯·æ±‚
- âœ… LunarCrush API å¯ä»¥æ­£å¸¸è°ƒç”¨
- âœ… Etherscan API å¯ä»¥æ­£å¸¸è°ƒç”¨

---

## ğŸ¯ å¦‚ä½•éªŒè¯ä¿®å¤

### æ­¥éª¤ 1: é‡å¯æœåŠ¡å™¨
```bash
# å¦‚æœæœåŠ¡å™¨è¿˜åœ¨è¿è¡Œ,æŒ‰ Ctrl+C åœæ­¢
# ç„¶åé‡æ–°å¯åŠ¨
pnpm dev
```

### æ­¥éª¤ 2: æµ‹è¯• LunarCrush API
åœ¨èŠå¤©ç•Œé¢è¾“å…¥:
```
What's the sentiment for Bitcoin?
```

### æ­¥éª¤ 3: æŸ¥çœ‹è¿”å›ç»“æœ

#### âœ… æˆåŠŸçš„æ ‡å¿— (çœŸå®æ•°æ®):
```
æ•°æ®æ¥æº: LunarCrush API (Real-time)
ç¤¾äº¤é‡: 15,234
ç¤¾äº¤ä¸»å¯¼åº¦: 12.5%
Galaxy Score: 72.3
Alt Rank: 8
```

#### âŒ å¤±è´¥çš„æ ‡å¿— (æ¨¡æ‹Ÿæ•°æ®):
```
KOL: CryptoWhale (500K ç²‰ä¸)
KOL: BlockchainAnalyst (350K ç²‰ä¸)
æ•°æ®æ¥æº: Simulated Data
```

### æ­¥éª¤ 4: æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—
å¦‚æœçœ‹åˆ°ç±»ä¼¼çš„æ—¥å¿—,è¯´æ˜æˆåŠŸ:
```
âœ“ LunarCrush API called successfully
âœ“ Data received for BTC
```

å¦‚æœçœ‹åˆ°é”™è¯¯,è¯´æ˜è¿˜æœ‰é—®é¢˜:
```
Social sentiment API error: ...
```

---

## ğŸ” å¯èƒ½çš„å…¶ä»–é—®é¢˜

### é—®é¢˜ 1: API Key æ— æ•ˆ

**ç—‡çŠ¶**: ä»ç„¶è¿”å›æ¨¡æ‹Ÿæ•°æ®,ä½†æ²¡æœ‰ "fetch failed" é”™è¯¯

**æ—¥å¿—**:
```
LunarCrush API error: 401
æˆ–
LunarCrush API error: 403
```

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥ `.env` æ–‡ä»¶ä¸­çš„ `LUNARCRUSH_API_KEY`
2. ç¡®è®¤ Key æ²¡æœ‰è¿‡æœŸ
3. è®¿é—® https://lunarcrush.com/developers/api ç¡®è®¤ Key çŠ¶æ€

### é—®é¢˜ 2: API é…é¢ç”¨å°½

**ç—‡çŠ¶**: è¿”å› 429 é”™è¯¯

**æ—¥å¿—**:
```
LunarCrush API error: 429 (Too Many Requests)
```

**è§£å†³æ–¹æ¡ˆ**:
1. ç­‰å¾…é…é¢é‡ç½®
2. å‡çº§ LunarCrush å¥—é¤
3. æ·»åŠ è¯·æ±‚ç¼“å­˜

### é—®é¢˜ 3: ç½‘ç»œè¿æ¥é—®é¢˜

**ç—‡çŠ¶**: é—´æ­‡æ€§å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥ç½‘ç»œè¿æ¥
2. æ£€æŸ¥é˜²ç«å¢™è®¾ç½®
3. å°è¯•ä½¿ç”¨ä»£ç†

---

## ğŸ“Š Runtime å¯¹æ¯”

### Edge Runtime
**ä¼˜ç‚¹**:
- âš¡ æ›´å¿«çš„å†·å¯åŠ¨
- ğŸŒ éƒ¨ç½²åˆ°è¾¹ç¼˜èŠ‚ç‚¹
- ğŸ’° æ›´ä¾¿å®œ(æŸäº›å¹³å°)

**ç¼ºç‚¹**:
- âŒ å—é™çš„ API (æŸäº› fetch è¢«é™åˆ¶)
- âŒ ä¸æ”¯æŒ Node.js ç‰¹å®šåŠŸèƒ½
- âŒ å¯¹å¤æ‚çš„å¤–éƒ¨ API è°ƒç”¨æ”¯æŒä¸å¥½

### Node.js Runtime (å½“å‰ä½¿ç”¨)
**ä¼˜ç‚¹**:
- âœ… å®Œæ•´çš„ Node.js åŠŸèƒ½
- âœ… æ— é™åˆ¶çš„ç½‘ç»œè¯·æ±‚
- âœ… æ›´å¥½çš„å…¼å®¹æ€§
- âœ… æ”¯æŒæ‰€æœ‰å¤–éƒ¨ API

**ç¼ºç‚¹**:
- âš ï¸ ç¨æ…¢çš„å†·å¯åŠ¨(å½±å“å¾ˆå°)
- âš ï¸ ä¸åœ¨è¾¹ç¼˜èŠ‚ç‚¹(ä½†å¯¹è¿™ä¸ªé¡¹ç›®å½±å“ä¸å¤§)

### ä¸ºä»€ä¹ˆé€‰æ‹© Node.js Runtime?

å¯¹äºè¿™ä¸ªé¡¹ç›®:
- éœ€è¦è°ƒç”¨å¤šä¸ªå¤–éƒ¨ API (LunarCrush, Etherscan, CoinGecko)
- å¤æ‚çš„æ•°æ®å¤„ç†
- AI å·¥å…·é“¾éœ€è¦å®Œæ•´çš„ç½‘ç»œåŠŸèƒ½

**Node.js Runtime æ›´åˆé€‚!**

---

## ğŸ‰ é¢„æœŸç»“æœ

ä¿®å¤å,å½“æ‚¨é—® "What's the sentiment for Bitcoin?" æ—¶:

### çœŸå®æ•°æ®ç¤ºä¾‹
```
ç›®å‰ BTC çš„ç¤¾äº¤æƒ…ç»ªåˆ†æ

æ•°æ®æ¥æº: LunarCrush API (Real-time)

æ•´ä½“æƒ…ç»ª: çœ‹æ¶¨
æƒ…ç»ªè¯„åˆ†: 65.30 (åŸºäºçœŸå®ç¤¾äº¤åª’ä½“æ•°æ®)

çœ‹æ¶¨æ¯”ä¾‹: 64.2%
çœ‹è·Œæ¯”ä¾‹: 35.8%

ç¤¾äº¤æŒ‡æ ‡:
- ç¤¾äº¤é‡: 15,234 å¸–å­
- ç¤¾äº¤å‚ä¸åº¦: 8,456 è´¡çŒ®è€…
- ç¤¾äº¤ä¸»å¯¼åº¦: 12.5%
- Alt Rank: 8

ä»·æ ¼ç›¸å…³æ€§:
- Galaxy Score: 72.3
- æ³¢åŠ¨ç‡: 2.45

ä¸»è¦è®¨è®ºä¸»é¢˜:
- ç¤¾äº¤é‡è¶‹åŠ¿
- ç¤¾åŒºå‚ä¸åˆ†æ
- ä»·æ ¼ç›¸å…³è®¨è®º
- å¸‚åœºæƒ…ç»ªè½¬å˜

çƒ­é—¨æ ‡ç­¾: #BTC #crypto #blockchain

æ—¶é—´æˆ³: 2025-10-23T20:00:00.000Z
```

---

## ğŸ”§ å¦‚æœè¿˜æ˜¯ä¸è¡Œ

### è°ƒè¯•æ­¥éª¤

1. **æ£€æŸ¥ç¯å¢ƒå˜é‡**
```bash
# ç¡®è®¤ .env æ–‡ä»¶å­˜åœ¨
ls -la .env

# æŸ¥çœ‹å†…å®¹ (éšè—æ•æ„Ÿä¿¡æ¯)
cat .env | grep LUNARCRUSH
```

2. **æ‰‹åŠ¨æµ‹è¯• API**
```bash
# ä½¿ç”¨ curl æµ‹è¯•
curl "https://api.lunarcrush.com/v2?data=assets&key=YOUR_KEY&symbol=BTC"
```

3. **æŸ¥çœ‹å®Œæ•´é”™è¯¯**
åœ¨ `src/lib/ai-tools.ts` çš„ `socialSentimentTool` ä¸­æ·»åŠ æ›´è¯¦ç»†çš„æ—¥å¿—:
```typescript
} catch (error) {
  console.error('Social sentiment API error:', error);
  console.error('Error details:', JSON.stringify(error, null, 2)); // æ·»åŠ è¿™è¡Œ
  // ...
}
```

4. **æµ‹è¯•å…¶ä»– API**
```
# æµ‹è¯• Etherscan (åº”è¯¥å·¥ä½œ)
"Show me Ethereum's on-chain data"

# æµ‹è¯• CoinGecko (åº”è¯¥å·¥ä½œ)
"What's the price of Bitcoin?"
```

---

## ğŸ“ æ€»ç»“

### ä¿®æ”¹å†…å®¹
- æ³¨é‡Šæ‰äº† `export const runtime = 'edge';`
- æ”¹ç”¨ Node.js Runtime

### é¢„æœŸæ•ˆæœ
- âœ… LunarCrush API æ­£å¸¸è°ƒç”¨
- âœ… è¿”å›çœŸå®çš„ç¤¾äº¤æƒ…ç»ªæ•°æ®
- âœ… æ‰€æœ‰ 5 ä¸ª AI å·¥å…·éƒ½ä½¿ç”¨çœŸå®æ•°æ®

### éªŒè¯æ–¹æ³•
- é‡å¯æœåŠ¡å™¨
- æé—®å¹¶æŸ¥çœ‹è¿”å›æ•°æ®
- æ£€æŸ¥æ˜¯å¦åŒ…å« "LunarCrush API (Real-time)"

---

**ç°åœ¨è¯·é‡æ–°æµ‹è¯•,åº”è¯¥å¯ä»¥çœ‹åˆ°çœŸå®æ•°æ®äº†!** ğŸ‰
